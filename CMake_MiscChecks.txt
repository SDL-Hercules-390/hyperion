#
# Misc checks for CMake-based build system
#

CHECK_SYMBOL_EXISTS(HAVE_FDATASYNC "unistd.h" HAVE_FDATASYNC)
CHECK_SYMBOL_EXISTS(in6_ifreq linux/ipv6.h HAVE_IPV6)

CHECK_SYMBOL_EXISTS(SO_KEEPALIVE "sys/socket.h" HAVE_BASIC_KEEPALIVE)

CHECK_SYMBOL_EXISTS(SIGBUS "sys/signal.h" HAVE_DECL_SIGBUS)
CHECK_SYMBOL_EXISTS(SIGPIPE "sys/signal.h" HAVE_DECL_SIGPIPE)
CHECK_SYMBOL_EXISTS(SIGUSR1 "sys/signal.h" HAVE_DECL_SIGUSR1)
CHECK_SYMBOL_EXISTS(SIGUSR2 "sys/signal.h" HAVE_DECL_SIGUSR2)

CHECK_SYMBOL_EXISTS(in_addr_t "netinet/in.h" HAVE_IN_ADDR_T)

CHECK_SYMBOL_EXISTS(timespec "sys/types.h" TIMESPEC_IN_SYS_TYPES_H)
CHECK_SYMBOL_EXISTS(timespec "time.h" TIMESPEC_IN_TIME_H)
CHECK_SYMBOL_EXISTS(socklen_t "netinet/in.h" HAVE_SOCKLEN_T)

CHECK_STRUCT_HAS_MEMBER("struct in_addr" s_addr "netinet/in.h" HAVE_STRUCT_IN_ADDR_S_ADDR)
CHECK_STRUCT_HAS_MEMBER("struct mtget" mt_gstat "sys/mtio.h" HAVE_STRUCT_MTGET_MT_GSTAT)

CHECK_TYPE_SIZE("int *" SIZEOF_INT_P)
CHECK_TYPE_SIZE("long" SIZEOF_LONG)
CHECK_TYPE_SIZE("long long" SIZEOF_LONG_LONG)
CHECK_TYPE_SIZE("off_t" SIZEOF_OFF_T)
CHECK_TYPE_SIZE("pthread_t" SIZEOF_PTHREAD_T)
CHECK_TYPE_SIZE("size_t" SIZEOF_SIZE_T)
CHECK_TYPE_SIZE("struct bytestruct" SIZEOF_STRUCT_BYTESTRUCT)

set(DRIVER_PREFIX "${CMAKE_INSTALL_PREFIX}/lib")
